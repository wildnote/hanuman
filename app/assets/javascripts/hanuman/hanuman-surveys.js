// Generated by CoffeeScript 2.7.0
$(function() {
  var $manuallyCalcDominanceWorksheet, $manuallyCalcPrevalenceWorksheet, $manuallySetIndicatorCB, $manuallySetIndicatorStatus, i, j, manuallySetIndicatorStatusString;
  if ($(".panel-observation").length > 0) {
    $(".panel-observation").each(function(index, element) {
      var question_id;
      question_id = $(element).attr('data-question-id');
      $(element).find('.panel-heading.chevron').attr("data-target", "#collapse_" + question_id + "_" + (index + 1));
      return $(element).find('.panel-collapse.in').attr("id", "collapse_" + question_id + "_" + (index + 1));
    });
  }
  // CHOSEN SINGLE SELECT
  // $(".chosen-select").prepend("<option value=''>&nbsp;</option>");
  $(".chosen-select").chosen({
    allow_single_deselect: true,
    no_results_text: "No results matched",
    size: "100%",
    single_backstroke_delete: false,
    search_contains: true
  });
  // CHOSEN MULTISELECT
  $(".chosen-multiselect").chosen({
    allow_single_deselect: true,
    no_results_text: "No results matched",
    size: "100%",
    single_backstroke_delete: false,
    search_contains: true
  });
  // END CHOSEN

  // Disable calculated fields
  $('.chosen-multiselect[readonly], .chosen-select[readonly]').parent().find('.chosen-container').css({
    'pointer-events': 'none',
    'opacity': 0.5
  });
  if ($('.form-container-survey').length > 0) {
    $manuallyCalcDominanceWorksheet = $('.form-container-survey').find("[data-api-column-name ='manually_calculate_dominance_test_worksheet']").find('input:checkbox:first');
    $manuallyCalcPrevalenceWorksheet = $('.form-container-survey').find("[data-api-column-name ='manually_calculate_prevalence_index_worksheet']").find('input:checkbox:first');
    // loop through all the potential manually_set_indicator_status in each veg repeater
    i = 0;
    while (i < 6) {
      j = i + 1;
      manuallySetIndicatorStatusString = "[data-api-column-name ='manually_set_indicator_status_" + j + "']";
      $manuallySetIndicatorStatus = $('.form-container-survey').find(manuallySetIndicatorStatusString);
      $manuallySetIndicatorCB = $manuallySetIndicatorStatus.find('input:checkbox:first');
      $manuallySetIndicatorCB.on("click", function() {
        // if checked re-enable indicator status in same repeater
        if ($(this).is(":checked")) {
          return $(this).parents('.form-container-entry-item').prev().find('.chosen-container').css({
            'pointer-events': 'auto',
            'opacity': 1
          });
        } else {
          return $(this).parents('.form-container-entry-item').prev().find('.chosen-container').css({
            'pointer-events': 'none',
            'opacity': .5
          });
        }
      });
      i++;
    }
    // found manually_set_indicator_status without an _X so finding that one too
    $manuallySetIndicatorCB = $('.form-container-survey').find("[data-api-column-name ='manually_set_indicator_status']").find('input:checkbox:first');
    $manuallySetIndicatorCB.on("click", function() {
      // if checked re-enable indicator status in same repeater
      if ($(this).is(":checked")) {
        return $(this).parents('.form-container-entry-item').prev().find('.chosen-container').css({
          'pointer-events': 'auto',
          'opacity': 1
        });
      } else {
        return $(this).parents('.form-container-entry-item').prev().find('.chosen-container').css({
          'pointer-events': 'none',
          'opacity': .5
        });
      }
    });
    i++;
    $manuallyCalcDominanceWorksheet.on("click", function() {
      if ($(this).is(":checked")) {
        return $(this).parents('.form-container-entry-item').nextAll().each(function() {
          var $dominantRadioButtons, results;
          console.log($(this).find('.form-control'));
          $(this).find('.form-control').attr('readonly', false);
          $dominantRadioButtons = $('.form-container-survey').find("[data-api-column-name ='vegetation_use_scientific_names_of_plants_dominant_species']").find('.form-control');
          $dominantRadioButtons.css({
            'pointer-events': 'auto',
            'opacity': 1,
            'cursor': 'auto'
          });
          $dominantRadioButtons.removeAttr("onclick");
          i = 0;
          results = [];
          while (i < 6) {
            j = i + 1;
            $dominantRadioButtons = $('.form-container-survey').find("[data-api-column-name ='vegetation_use_scientific_names_of_plants_dominant_species_" + j + "']").find('.form-control');
            $dominantRadioButtons.css({
              'pointer-events': 'auto',
              'opacity': 1,
              'cursor': 'auto'
            });
            $dominantRadioButtons.removeAttr("onclick");
            results.push(i++);
          }
          return results;
        });
      } else {
        return $(this).parents('.form-container-entry-item').nextAll().each(function() {
          var $dominantRadioButtons, results;
          $(this).find('.form-control').attr('readonly', true);
          $dominantRadioButtons = $('.form-container-survey').find("[data-api-column-name ='vegetation_use_scientific_names_of_plants_dominant_species']").find('.form-control');
          $dominantRadioButtons.css({
            'pointer-events': 'auto',
            'opacity': .5,
            'cursor': 'not-allowed'
          });
          $dominantRadioButtons.on("click", function() {
            return false;
          });
          i = 0;
          results = [];
          while (i < 6) {
            j = i + 1;
            $dominantRadioButtons = $('.form-container-survey').find("[data-api-column-name ='vegetation_use_scientific_names_of_plants_dominant_species_" + j + "']").find('.form-control');
            $dominantRadioButtons.css({
              'pointer-events': 'auto',
              'opacity': .5,
              'cursor': 'not-allowed'
            });
            $dominantRadioButtons.on("click", function() {
              return false;
            });
            results.push(i++);
          }
          return results;
        });
      }
    });
    return $manuallyCalcPrevalenceWorksheet.on("click", function() {
      if ($(this).is(":checked")) {
        return $(this).parents('.form-container-entry-item').nextAll().each(function() {
          console.log($(this).find('.form-control'));
          return $(this).find('.form-control').attr('readonly', false);
        });
      } else {
        return $(this).parents('.form-container-entry-item').nextAll().each(function() {
          return $(this).find('.form-control').attr('readonly', true);
        });
      }
    });
  }
});
